<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ“ã‚¸ãƒã‚¹ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ è¨˜è¿°å¼ã‚¯ã‚¤ã‚º</title>

<style>
  body {
    font-family: sans-serif;
    margin: 0;
    padding: 16px;
    background: #f4f4f4;
  }
  .container {
    max-width: 700px;
    margin: auto;
    background: #fff;
    padding: 16px;
    border-radius: 8px;
  }
  h1 { text-align: center; }

  #question {
    margin: 16px 0;
    padding: 14px;
    min-height: 40px;
    background: #fafafa;
    border: 2px solid #333;
    border-radius: 6px;
    font-size: 1.1rem;
    line-height: 1.7;
    color: #000;
    display: block !important;
    visibility: visible !important;
    white-space: normal;
    word-break: break-word;
  }

  textarea { width: 100%; height: 90px; font-size: 1rem; }
  button { margin-top: 10px; padding: 10px; font-size: 1rem; width: 100%; }
  
  #nextButton {
    background: #4caf50;
    color: white;
    border: none;
    cursor: pointer;
  }
  
  #nextButton:hover {
    background: #45a049;
  }
  
  #nextSetButton {
    background: #2196f3;
    color: white;
    border: none;
    cursor: pointer;
    margin-top: 15px;
  }
  
  #nextSetButton:hover {
    background: #1976d2;
  }

  .hidden { display: none; }

  #progress { margin-top: 10px; font-size: 0.9rem; color: #555; }
  #model {
    margin-top: 10px;
    padding: 10px;
    background: #eef;
    border-radius: 5px;
  }
  
  #errorMessage {
    margin-top: 10px;
    padding: 10px;
    background: #ffebee;
    border: 1px solid #f44336;
    border-radius: 5px;
    color: #c62828;
    font-size: 0.95rem;
  }
  
  #scoreDisplay {
    margin-top: 20px;
    padding: 20px;
    background: #e8f5e9;
    border: 2px solid #4caf50;
    border-radius: 8px;
    text-align: center;
    font-size: 1.2rem;
  }
  
  #scoreDisplay h2 {
    margin: 0 0 10px 0;
    color: #2e7d32;
  }
  
  #scoreDisplay p {
    margin: 5px 0;
    font-size: 1.1rem;
  }
  
  #scoreDisplay .percentage {
    font-size: 2rem;
    font-weight: bold;
    color: #1b5e20;
    margin: 10px 0;
  }
  
  #incorrectList {
    margin-top: 20px;
    padding: 20px;
    background: #ffebee;
    border: 2px solid #f44336;
    border-radius: 8px;
    text-align: left;
  }
  
  #incorrectList h3 {
    margin: 0 0 15px 0;
    color: #c62828;
    text-align: center;
  }
  
  .incorrect-item {
    margin-bottom: 15px;
    padding: 12px;
    background: #fff;
    border-left: 4px solid #f44336;
    border-radius: 4px;
  }
  
  .incorrect-item .question-text {
    font-weight: bold;
    color: #333;
    margin-bottom: 5px;
  }
  
  .incorrect-item .answer-text {
    color: #666;
    font-size: 0.95rem;
  }
</style>
</head>

<body>
<div class="container">
  <h1>ãƒ“ã‚¸ãƒã‚¹ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ<br>è¨˜è¿°å¼ã‚¯ã‚¤ã‚º</h1><br>
  <h3>å¤§æ–‡å­—å°æ–‡å­—ã€ãƒ»ã‚‚æ­£ã—ãå…¥ã‚Œã¾ã—ã‚‡ã†ã€‚è‹±èªã¯åŠè§’ã§å…¥ã‚Œã¦ãã ã•ã„</h3>

  <div id="question"></div>
  <textarea id="answer" placeholder="ç­”ãˆã‚’å…¥åŠ›"></textarea>
  <button id="checkButton" onclick="checkAnswer()">ç­”ãˆåˆã‚ã›</button>
  <button id="nextButton" class="hidden" onclick="nextQuestion()">æ¬¡ã®å•é¡Œã¸ â†’</button>
  
  <div id="errorMessage" class="hidden"></div>
  <div id="result"></div>
  <div id="model" class="hidden"></div>
  <div id="progress"></div>
  <div id="scoreDisplay" class="hidden"></div>
  <div id="incorrectList" class="hidden"></div>
  <button id="nextSetButton" class="hidden" onclick="startNextSet()">ã‚‚ã†ä¸€åº¦15å•ã«æŒ‘æˆ¦ ğŸ”„</button>
</div>

<script>
const quiz = [];
</script>

<script>
// ===== å•é¡Œãƒ‡ãƒ¼ã‚¿(èª¬æ˜æ–‡â†’å˜èªå½¢å¼) =====
const quizData = [

 {q:"ãƒ“ã‚¸ãƒã‚¹ã®å­˜ç¶šã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã•ã¾ã–ã¾ãªè¦å› ã‚’ï¼Œãƒ“ã‚¸ãƒã‚¹ã®å¤–éƒ¨ç’°å¢ƒã¨å†…éƒ¨ç’°å¢ƒã®ä¸¡æ–¹ã‹ã‚‰æ•´ç†ã™ã‚‹åˆ†ææ–¹æ³•ã‚’ä½•ã¨ã„ã†ã‹ã€‚",a:["swotåˆ†æ","swotåˆ†æ"],model:"SWOTåˆ†æ"},

];

// ===== 15å•åŒºåˆ‡ã‚Šè¨­å®š =====
const SET_SIZE = 15;
let order = [];
let index = 0;
let setIndex = 0;
let checked = false;
let correctCount = 0; // æ­£è§£æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
let incorrectQuestions = []; // é–“é•ãˆãŸå•é¡Œã‚’è¨˜éŒ²

function startSet() {
  // æ¯å›å•é¡Œã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  order = [...Array(quizData.length).keys()];
  order.sort(() => Math.random() - 0.5);
  
  // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’0ã«ãƒªã‚»ãƒƒãƒˆï¼ˆã‚·ãƒ£ãƒƒãƒ•ãƒ«æ¸ˆã¿ã®é…åˆ—ã‚’ä½¿ç”¨ï¼‰
  index = 0;
  correctCount = 0; // ãƒªã‚»ãƒƒãƒˆ
  incorrectQuestions = []; // ãƒªã‚»ãƒƒãƒˆ
  
  // ç”»é¢ã‚’ãƒªã‚»ãƒƒãƒˆ
  document.getElementById('scoreDisplay').classList.add('hidden');
  document.getElementById('incorrectList').classList.add('hidden');
  document.getElementById('nextSetButton').classList.add('hidden');
  document.getElementById('answer').style.display = 'block';
  document.getElementById('checkButton').style.display = 'block';
  document.getElementById('checkButton').classList.remove('hidden');
  document.getElementById('nextButton').style.display = 'block';
  document.getElementById('nextButton').classList.add('hidden');
  document.getElementById('result').style.display = 'block';
  document.getElementById('model').style.display = 'none';
  document.getElementById('progress').style.display = 'block';
  document.getElementById('errorMessage').classList.add('hidden');
  document.getElementById('errorMessage').style.display = 'none';
  
  showQuestion();
}

function showQuestion() {
  const qElm = document.getElementById('question');
  const q = quizData[order[index]];
  if (!q) {
    qElm.textContent = "ã“ã®ã‚»ãƒƒãƒˆã¯çµ‚äº†ã§ã™";
    return;
  }
  qElm.textContent = q.q;
  document.getElementById('answer').value = '';
  document.getElementById('result').textContent = '';
  
  // æ¨¡ç¯„è§£ç­”ã‚’ç¢ºå®Ÿã«ãƒªã‚»ãƒƒãƒˆ
  const modelElm = document.getElementById('model');
  modelElm.textContent = '';
  modelElm.classList.add('hidden');
  
  document.getElementById('errorMessage').classList.add('hidden');
  document.getElementById('progress').textContent =
    `${index + 1} / ${SET_SIZE}å•ç›®`;
  checked = false;
  
  // ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
  document.getElementById('checkButton').classList.remove('hidden');
  document.getElementById('nextButton').classList.add('hidden');
  
  // å›ç­”æ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
  document.getElementById('answer').focus();
}

function checkAnswer() {
  if (checked) return;

  const user = document.getElementById('answer').value.trim();
  const errorMessage = document.getElementById('errorMessage');
  
  // å›ç­”ãŒç©ºã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
  if (user === '') {
    errorMessage.textContent = 'âš ï¸ å›ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
    errorMessage.classList.remove('hidden');
    return;
  }
  
  // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º
  errorMessage.classList.add('hidden');
  
  const userLower = user.toLowerCase();
  const q = quizData[order[index]];
  const result = document.getElementById('result');
  const model = document.getElementById('model');

  const correct = q.a.some(word => userLower.includes(word));
  result.textContent = correct ? "â­• æ­£è§£!" : "âŒ ä¸æ­£è§£";
  
  // æ¨¡ç¯„è§£ç­”ã‚’ç¢ºå®Ÿã«è¡¨ç¤º
  model.textContent = "æ¨¡ç¯„è§£ç­”: " + q.model;
  model.style.display = 'block';
  model.classList.remove('hidden');

  // æ­£è§£æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
  if (correct) {
    correctCount++;
  } else {
    // é–“é•ãˆãŸå•é¡Œã‚’è¨˜éŒ²
    incorrectQuestions.push({
      question: q.q,
      model: q.model
    });
  }

  checked = true;
  
  // ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
  document.getElementById('checkButton').classList.add('hidden');
  document.getElementById('nextButton').classList.remove('hidden');
  
  // æ¬¡ã®å•é¡Œã¸ãƒœã‚¿ãƒ³ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
  document.getElementById('nextButton').focus();
}

function nextQuestion() {
  index++;
  
  if (index < SET_SIZE && quizData[order[index]]) {
    showQuestion();
  } else {
    // 15å•çµ‚äº†æ™‚ã«çµæœã‚’è¡¨ç¤º
    showFinalScore();
  }
}

function showFinalScore() {
  const qElm = document.getElementById('question');
  const scoreDisplay = document.getElementById('scoreDisplay');
  const incorrectList = document.getElementById('incorrectList');
  const nextSetButton = document.getElementById('nextSetButton');
  const actualQuestions = Math.min(index, SET_SIZE);
  const percentage = Math.round((correctCount / actualQuestions) * 100);
  
  qElm.textContent = actualQuestions + "å•çµ‚äº†!";
  
  scoreDisplay.innerHTML = `
    <h2>ğŸ‰ çµæœç™ºè¡¨ ğŸ‰</h2>
    <p>æ­£è§£æ•°: <strong>${correctCount}</strong> / ${actualQuestions}å•</p>
    <div class="percentage">${percentage}%</div>
    <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
      å•é¡Œã¯ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚Œã‚‹ã®ã§ã€ä½•åº¦ã§ã‚‚æŒ‘æˆ¦ã§ãã¾ã™ï¼
    </p>
  `;
  scoreDisplay.classList.remove('hidden');
  
  // é–“é•ãˆãŸå•é¡Œã®ä¸€è¦§ã‚’è¡¨ç¤º
  if (incorrectQuestions.length > 0) {
    let incorrectHTML = '<h3>âŒ é–“é•ãˆãŸå•é¡Œä¸€è¦§</h3>';
    incorrectQuestions.forEach((item, idx) => {
      incorrectHTML += `
        <div class="incorrect-item">
          <div class="question-text">${idx + 1}. ${item.question}</div>
          <div class="answer-text">æ¨¡ç¯„è§£ç­”: ${item.model}</div>
        </div>
      `;
    });
    incorrectList.innerHTML = incorrectHTML;
    incorrectList.classList.remove('hidden');
  }
  
  // å¸¸ã«æ¬¡ã®ã‚»ãƒƒãƒˆã¸ã®ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºï¼ˆå•é¡Œã¯æ¯å›ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚Œã‚‹ï¼‰
  nextSetButton.classList.remove('hidden');
  nextSetButton.focus();
  
  // å…¥åŠ›æ¬„ã¨ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
  document.getElementById('answer').style.display = 'none';
  document.getElementById('checkButton').style.display = 'none';
  document.getElementById('nextButton').style.display = 'none';
  document.getElementById('result').style.display = 'none';
  document.getElementById('model').style.display = 'none';
  document.getElementById('progress').style.display = 'none';
  document.getElementById('errorMessage').style.display = 'none';
}

function startNextSet() {
  startSet();
}

// Enterã‚­ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
document.addEventListener('DOMContentLoaded', function() {
  const answerField = document.getElementById('answer');
  const checkButton = document.getElementById('checkButton');
  const nextButton = document.getElementById('nextButton');
  
  // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã§ã®Enterã‚­ãƒ¼å‡¦ç†
  answerField.addEventListener('keydown', function(event) {
    // Ctrl+Enterã¾ãŸã¯Shift+Enterã®å ´åˆã¯æ”¹è¡Œã‚’è¨±å¯
    if (event.ctrlKey || event.shiftKey) {
      return;
    }
    
    // Enterã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸå ´åˆ
    if (event.key === 'Enter') {
      event.preventDefault(); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ”¹è¡Œã‚’é˜²ã
      
      // ç­”ãˆåˆã‚ã›ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆ
      if (!checkButton.classList.contains('hidden')) {
        checkAnswer();
      }
      // æ¬¡ã®å•é¡Œã¸ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆ
      else if (!nextButton.classList.contains('hidden')) {
        nextQuestion();
      }
    }
  });
  
  // æ¬¡ã®å•é¡Œã¸ãƒœã‚¿ãƒ³ã§ã®Enterã‚­ãƒ¼å‡¦ç†
  nextButton.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
      event.preventDefault();
      nextQuestion();
    }
  });
  
  // æ¬¡ã®ã‚»ãƒƒãƒˆã¸ãƒœã‚¿ãƒ³ã§ã®Enterã‚­ãƒ¼å‡¦ç†
  document.getElementById('nextSetButton').addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
      event.preventDefault();
      startNextSet();
    }
  });
});

window.onload = startSet;
</script>
</body>
</html>
